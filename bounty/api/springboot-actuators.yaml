id: springboot-actuators

info:
  name: Detect the exposure of Springboot Actuators
  author: that_juan_ & dwisiswant0
  severity: high
  tags: spring,springboot

http:
  - method: GET
    path:
      - "{{BaseURL}}/..;/actuator"
      - "{{BaseURL}}/..;/actuator/auditevents"
      - "{{BaseURL}}/..;/actuator/beans"
      - "{{BaseURL}}/..;/actuator/conditions"
      - "{{BaseURL}}/..;/actuator/configprops"
      - "{{BaseURL}}/..;/actuator/env"
      - "{{BaseURL}}/..;/actuator/health"
      - "{{BaseURL}}/..;/actuator/heapdump"
      - "{{BaseURL}}/..;/actuator/httptrace"
      - "{{BaseURL}}/..;/actuator/hystrix.stream"
      - "{{BaseURL}}/..;/actuator/info"
      - "{{BaseURL}}/..;/actuator/jolokia"
      - "{{BaseURL}}/..;/actuator/logfile"
      - "{{BaseURL}}/..;/actuator/loggers"
      - "{{BaseURL}}/..;/actuator/mappings"
      - "{{BaseURL}}/..;/actuator/metrics"
      - "{{BaseURL}}/..;/actuator/scheduledtasks"
      - "{{BaseURL}}/..;/actuator/swagger-ui.html"
      - "{{BaseURL}}/..;/actuator/threaddump"
      - "{{BaseURL}}/..;/actuator/trace"
      - "{{BaseURL}}/actuator"
      - "{{BaseURL}}/actuator/auditevents"
      - "{{BaseURL}}/actuator/auditLog"
      - "{{BaseURL}}/actuator/beans"
      - "{{BaseURL}}/actuator/caches"
      - "{{BaseURL}}/actuator/conditions"
      - "{{BaseURL}}/actuator/configprops"
      - "{{BaseURL}}/actuator/configurationMetadata"
      - "{{BaseURL}}/actuator/dump"
      - "{{BaseURL}}/actuator/env"
      - "{{BaseURL}}/actuator/events"
      - "{{BaseURL}}/actuator/exportRegisteredServices"
      - "{{BaseURL}}/actuator/features"
      - "{{BaseURL}}/actuator/flyway"
      - "{{BaseURL}}/actuator/health"
      - "{{BaseURL}}/actuator/healthcheck"
      - "{{BaseURL}}/actuator/heapdump"
      - "{{BaseURL}}/actuator/httptrace"
      - "{{BaseURL}}/actuator/hystrix.stream"
      - "{{BaseURL}}/actuator/info"
      - "{{BaseURL}}/actuator/integrationgraph"
      - "{{BaseURL}}/actuator/jolokia"
      - "{{BaseURL}}/actuator/liquibase"
      - "{{BaseURL}}/actuator/logfile"
      - "{{BaseURL}}/actuator/loggers"
      - "{{BaseURL}}/actuator/loggingConfig"
      - "{{BaseURL}}/actuator/management"
      - "{{BaseURL}}/actuator/mappings"
      - "{{BaseURL}}/actuator/metrics"
      - "{{BaseURL}}/actuator/refresh"
      - "{{BaseURL}}/actuator/registeredServices"
      - "{{BaseURL}}/actuator/releaseAttributes"
      - "{{BaseURL}}/actuator/resolveAttributes"
      - "{{BaseURL}}/actuator/scheduledtasks"
      - "{{BaseURL}}/actuator/sessions"
      - "{{BaseURL}}/actuator/shutdown"
      - "{{BaseURL}}/actuator/springWebflow"
      - "{{BaseURL}}/actuator/sso"
      - "{{BaseURL}}/actuator/ssoSessions"
      - "{{BaseURL}}/actuator/statistics"
      - "{{BaseURL}}/actuator/status"
      - "{{BaseURL}}/actuator/threaddump"
      - "{{BaseURL}}/actuator/trace"
      - "{{BaseURL}}/auditevents"
      - "{{BaseURL}}/autoconfig"
      - "{{BaseURL}}/beans"
      - "{{BaseURL}}/cloudfoundryapplication"
      - "{{BaseURL}}/configprops"
      - "{{BaseURL}}/dump"
      - "{{BaseURL}}/env"
      - "{{BaseURL}}/health"
      - "{{BaseURL}}/heapdump"
      - "{{BaseURL}}/hystrix.stream"
      - "{{BaseURL}}/info"
      - "{{BaseURL}}/jolokia"
      - "{{BaseURL}}/jolokia/list"
      - "{{BaseURL}}:8090/jolokia"
      - "{{BaseURL}}:8090/jolokia/list"
      - "{{BaseURL}}/loggers"
      - "{{BaseURL}}/management"
      - "{{BaseURL}}/mappings"
      - "{{BaseURL}}/metrics"
      - "{{BaseURL}}/threaddump"
      - "{{BaseURL}}/trace"
      - "{{BaseURL}}/actuator/..;/..;/heapdump"
      - "{{BaseURL}}/appenv"
      - "{{BaseURL}}/api/env"
      - "{{BaseURL}}/1/..;/env"
      - "{{BaseURL}}/1/..;/actuator/env"
      - "{{BaseURL}}/actuator;/env;"
      - "{{BaseURL}}/message-api/actuator/env"
      - "{{BaseURL}}/..;/dump"
      - "{{BaseURL}}/..;/entity/all"
      - "{{BaseURL}}/..;/env"
      - "{{BaseURL}}/..;/eureka"
      - "{{BaseURL}}/..;/flyway"
      - "{{BaseURL}}/..;/gateway/actuator"
      - "{{BaseURL}}/..;/gateway/actuator/auditevents"
      - "{{BaseURL}}/..;/gateway/actuator/beans"
      - "{{BaseURL}}/..;/gateway/actuator/conditions"
      - "{{BaseURL}}/..;/gateway/actuator/configprops"
      - "{{BaseURL}}/..;/gateway/actuator/env"
      - "{{BaseURL}}/..;/gateway/actuator/health"
      - "{{BaseURL}}/..;/gateway/actuator/heapdump"
      - "{{BaseURL}}/..;/gateway/actuator/httptrace"
      - "{{BaseURL}}/..;/gateway/actuator/hystrix.stream"
      - "{{BaseURL}}/..;/gateway/actuator/info"
      - "{{BaseURL}}/..;/gateway/actuator/jolokia"
      - "{{BaseURL}}/..;/gateway/actuator/logfile"
      - "{{BaseURL}}/..;/gateway/actuator/loggers"
      - "{{BaseURL}}/..;/gateway/actuator/mappings"
      - "{{BaseURL}}/..;/gateway/actuator/metrics"
      - "{{BaseURL}}/..;/gateway/actuator/scheduledtasks"
      - "{{BaseURL}}/..;/gateway/actuator/swagger-ui.html"
      - "{{BaseURL}}/..;/gateway/actuator/threaddump"
      - "{{BaseURL}}/..;/gateway/actuator/trace"
      - "{{BaseURL}}/..;/health"
      - "{{BaseURL}}/..;/heapdump"
      - "{{BaseURL}}/..;/heapdump.json"
      - "{{BaseURL}}/..;/httptrace"
      - "{{BaseURL}}/..;/hystrix"
      - "{{BaseURL}}/..;/hystrix.stream"
      - "{{BaseURL}}/..;/info"
      - "{{BaseURL}}/..;/intergrationgraph"
      - "{{BaseURL}}/..;/jolokia"
      - "{{BaseURL}}/..;/jolokia/list"
      - "{{BaseURL}}/..;/libs/swaggerui"
      - "{{BaseURL}}/..;/liquibase"
      - "{{BaseURL}}/..;/logfile"
      - "{{BaseURL}}/..;/loggers"
      - "{{BaseURL}}/..;/mappings"
      - "{{BaseURL}}/..;/metrics"
      - "{{BaseURL}}/..;/monitor"
      - "{{BaseURL}}/..;/prometheus"
      - "{{BaseURL}}/..;/refresh"
      - "{{BaseURL}}/..;/scheduledtasks"
      - "{{BaseURL}}/..;/sessions"
      - "{{BaseURL}}/..;/threaddump"
      - "{{BaseURL}}/..;/trace"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "method"
          - "spring"
          - "TYPE"
          - "system"
          - "database"
          - "cron"
          - "reloadByURL"
          - "JMXConfigurator"
          - "JMImplementation"
          - "EnvironmentManager"
          - "applicationConfig"
        condition: or

      - type: status
        status:
          - 200
          
      - type: word
        words:
          - "X-Application-Context"
          - "application/json"
          - "application/vnd.spring-boot.actuator.v2+json"
          - "hprof"
          - "application/json"
          - "application/vnd.spring-boot.actuator"
          - "application/vnd.spring-boot.actuator.v3+json"
        condition: or
        part: header